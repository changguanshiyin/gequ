(function(t,e,o,n){var i={lists:function(e){return t("img[data-src]")},load:function(o){var n=o||this.lists(),i=0,a=this,r=function s(){if(n.length==i)return t(e).unbind("scroll",s),void t(e).unbind("resize",s);t(n).each((function(){var o,n=t(this);n.data("loaded")||t(e).scrollTop()<=n.offset().top&&t(e).scrollTop()+t(e).height()>=n.offset().top&&((o=a.getImgSize(n))&&n.attr("width","100%").attr("height",o),n.attr("src",n.attr("data-src")),n.data("loaded","true"),i++)}))};t(e).bind("scroll",r),t(e).bind("resize",r),r()},getImgSize:function(e){var o,n,i;if(n=t(e).parent().width(),t(e).attr("width")&&t(e).attr("height"))return o=t(e).attr("width"),i=t(e).attr("height"),o<n?null:i*(n/o);var a=new Image;a.onload=a.onerror=a.onabort=function(){return this.onload=this.onerror=this.onabort=null,o=this.width,i=this.height,o&&i?i*(n/o):null}}};function a(e,o){var n=e.outerWidth();e.outerHeight(),t(e).html(""),t(e).qrcode({size:n,text:o})}function r(){if(1!=t("body").attr("data-islogin"))return e.location.href=o.data.loginUrl,!1}i.load(),t(".twemoji").each((function(t,e){twemoji&&twemoji.parse(e)})),function(){t(".qr-code-tips a").on("mouseover",(function(){t(".qr-code").attr("loaded")||(a(t(".qr-code-tips .qr-code .qr"),location.origin+location.pathname+location.search),t(".qr-code").attr("loaded","true")),t(".qr-code").addClass("cur")})),t("body").on("mouseover",(function(e){var o=e.target||e.srcElement;(o=t(o)).hasClass("qr-code-tips")||0!=t(".qr-code-tips").has(o).length||t(".qr-code").removeClass("cur")}));var e,o,n,i,s,d,c=t(".widget-download-layer");t(".download a").on("click",(function(){e=t(this).attr("link"),o=t(this).hasClass("ios")?"唱吧IOS版":"唱吧Android版",c.find(".title").html(o),a(c.find(".qr-wrapper a"),e),c.find(".dl-to-pc a").attr("href",e),c.show()})),c.find(".close").on("click",(function(){t(".widget-download-layer").hide()})),c.on("click",(function(e){var o=e.target||e.srcElement;((o=t(o)).hasClass("cover")||0==t(".cover").has(o).length)&&t(".widget-download-layer").hide()})),t(".focus",".focus-follower").on("click",(function(){n=t(this).attr("data-status"),i=t(this).attr("data-userid"),d=this,n&&n>1||(r(),t.getJSON("/member/personcenter/oprUserRelation.php?status=0&wid="+encodeURIComponent(i),(function(e){e&&"no"==e.message?t(d).removeAttr("data-status").find("em").html("已关注"):e&&e.message&&alert(e.message)})))})),t(".fav",".work-info").on("click",(function(){n=t(this).attr("data-status"),s=t(this).attr("data-workid"),d=this,n&&0!=n||(r(),t.getJSON("/now/collectWork.php?ac=collect&workid="+encodeURIComponent(s),(function(e){e&&0==e.errorCode?t(d).removeAttr("data-status").find("em").html("已收藏"):e&&e.result&&alert(e.result)})))}))}();var s=function(){this.count=Number(t("body").attr("data-count")),this.page=1,this.size=9,this.data={},this.pageCount=Math.ceil(this.count/this.size),this.workid=t("body").attr("data-workid"),this.container=t(".widget-comment .comment-list"),this.url="/now/getComments.php?",this.controller=t(".controller a[data-action]"),this.loadTag=!0};s.prototype.init=function(){this.container.find("ul").length<1?this.container.css("height",this.container.find(".no-comment-tips").outerHeight(!0)):this.container.css("height",this.container.find("ul").outerHeight()),this.bindEvent()},s.prototype.getCommentData=function(e){var o=e,n=this;"prev"!=o||1!=n.page?"next"!=o||n.page!=n.pageCount?(n.page="next"==o?n.page+1:n.page-1,n.controller.css("visibility","visible"),1==n.page&&n.controller.filter("[data-action=prev]").css("visibility","hidden"),n.page==n.pageCount&&n.controller.filter("[data-action=next]").css("visibility","hidden"),n.data[n.page]?n.getCommentPainted(n.data[n.page]):(n.loadTag=!1,t.getJSON(n.url+"workid="+encodeURIComponent(n.workid)+"&page="+n.page+"&pageSize="+n.size,(function(t){t&&0==t.errorcode&&(n.getCommentPainted(t.result.comments),n.data[n.page]=t.result.comments,n.loadTag=!0)})))):n.controller.filter("[data-action=next]").css("visibility","hidden"):n.controller.filter("[data-action=prev]").css("visibility","hidden")},s.prototype.getCommentPainted=function(e){var o=e,n="",a=t('<ul class="clearfix" />');if(!(o.length<0)){for(var r=0;r<o.length;r++)n+='<li class="items"><a class="poster" href="javascript:;"><img src="//cb.cdn.changbaimg.com/images/now/show/photo-default.png" data-src="'+(o[r].user.headphoto?o[r].user.headphoto.replace("http://","//").replace(".jpg","_200_200.jpg"):"//cb.cdn.changbaimg.com/images/now/show/photo-default.png")+'"></a><div class="info"><span class="uinfo"><a class="uname twemoji" href="javascript:;">'+o[r].user.nickname+'</a><em class="post-time">'+o[r].time+'</em></span><span class="content twemoji">'+(/^\[Жs.*\]$/.test(o[r].content)?'<img src="//aliimg.changba.com/cache/photo/s'+o[r].content.substring("[Ж/".length,o[r].content.indexOf("]"))+'" style="height: 50px;" />':o[r].content)+"</span></div></li>";a.html(n).css("display","none").appendTo(this.container),this.container.css("height",a.outerHeight()),n=null,a.siblings("ul").fadeOut("slow",(function(){t(this).remove()})),a.fadeIn("slow"),t(".twemoji",a).each((function(t,e){twemoji&&twemoji.parse(e)})),i.load(a.find("img[data-src]"))}},s.prototype.bindEvent=function(){var e,o=this;o.controller.on("click",(function(){o.loadTag&&(e=t(this).attr("data-action"),o.getCommentData(e))}))},(new s).init();var d=String.fromCharCode.apply(String,[97,49,55,102,101,55,52,101,52,50,49,99,50,99,98,102,51,100,99,51,50,51,102,52,98,52,102,51,97,49,97,102]),c=CryptoJS.enc.Utf8.parse(d.substring(0,16)),l=CryptoJS.enc.Utf8.parse(d.substring(16)),u="";o.url?(u=CryptoJS.AES.decrypt(o.url,l,{iv:c,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8),document.getElementById("audio").src=u.replace("http://","//")):n&&n.video_url&&(u=CryptoJS.AES.decrypt(n.video_url,l,{iv:c,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8),n.video_url=u)})(jQuery,window,window.commonObj,window.jplayer),function(t){function e(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e||(e=window.location.href);var o=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null==o?"":decodeURIComponent(o[1].replace(/\+/g," "))}function o(){this.dom=null}o.uiMode={Full:"full",Mini:"mini",None:"none",Invisible:"invisible"},o.prototype={CreateAt:function(t){this.dom=document.createElement("object"),this.dom.classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6",window.dom=this.dom;var e=document.getElementById(t);e.innerHTML="",e.appendChild(this.dom),this._Init()},BindID:function(t){this.dom=document.getElementById(t),this._Init()},_Init:function(){var t=this;window.attachEvent||(this.dom.attachEvent=function(t,e){}),this.dom.attachEvent("PlayStateChange",(function(e){t.onPlayStateChange(e)})),this.dom.attachEvent("Buffering",(function(e){t.onBuffering(e)})),this.dom.attachEvent("Error",(function(){t.onError()})),this.dom.attachEvent("PositionChange",(function(e,o){t.onPositionChange(e,o)})),this.dom.attachEvent("StatusChange",(function(e){t.onStatusChange(e)}))},onPlayStateChange:function(t){switch(t){case 1:this.onStop();break;case 2:this.onPaused();break;case 3:this.onPlay(),this.hasLoaded||(this.onReady(),this.hasLoaded=!0);break;case 4:case 5:break;case 6:this.onBuffering_SC();break;case 7:break;case 8:this.onMediaEnded();break;case 9:this.onTransitioning()}},onStop:function(){},onPaused:function(){},onPlay:function(){},onBuffering_SC:function(){},onTransitioning:function(){},onMediaEnded:function(){},onError:function(){},onPositionChange:function(t,e){},onStatusChange:function(){},onBuffering:function(t){},onReady:function(){},setMode:function(t){this.dom.uiMode=t},setVolume:function(t){this.dom.settings.volume=t},setAutoStart:function(t){this.dom.settings.autoStart=t},getMediaName:function(){var t=this.dom.currentMedia;return t?t.name:""},getMediaDuration:function(){var t=this.dom.currentMedia;return t?t.duration:""},getMediaDurationString:function(){var t=this.dom.currentMedia;return t?t.durationString:""},getStatus:function(){return this.dom.status},getPosition:function(){return this.dom.controls.currentPosition},setPosition:function(t){this.dom.controls.currentPosition=t},getPositionString:function(){return this.dom.controls.currentPositionString},getPlayState:function(){return this.dom.playState},OpenUrl:function(t){this.dom.URL=t},Play:function(){this.dom.controls.play()},Pause:function(){this.dom.controls.pause()},Stop:function(){this.dom.controls.stop()}},new o;var n=function(){this.processBtn=t("#process-btn"),this.playedProcessBar=t("#work-played-bar"),this.audio=document.getElementById("audio"),this.hasAudio=!!document.createElement("audio").canPlayType,this.lrcContainer=t("#lrc_container"),this.LrcTimerId=0};n.prototype.init=function(){if(!this.hasAudio&&this.audio){var n=this.mpl=new o;n.CreateAt("audio_container"),n.setVolume(100),n.setMode(o.uiMode.Invisible),n.setAutoStart(!0)}t(".twemoji").each((function(t,e){twemoji&&twemoji.parse(e)}));var i=this._czc=window._czc||[];i.push(["_setAccount","1254909905"]),i.push(["_trackEvent","page","source",e("source"),0,"body"]),this.bindEvents()},n.prototype.bindEvents=function(){var e=this,o=t(".time-counter").children().first();function n(){e.processBtn.on("mousedown",(function(t){e.processBtn.data("mousedown",!0),t=t||window.event,e.processBtn.data("offsetX",(t.clientX||t.pageX)-e.playedProcessBar.width())})),t(document).on("mouseup",(function(){e.processBtn.data("mousedown",!1),e.processBtn.data("offsetX",undefined)})).on("mousemove",(function(n){if(e.processBtn.data("mousedown")){var r=(n=n||window.event).clientX||n.pageX;e.processBtn.data("offsetX")||e.processBtn.data("offsetX",r);var s=r-e.processBtn.data("offsetX");if(s<0)return e.playedProcessBar.width(0),o.html("00:00"),e.audio?e.hasAudio?e.audio.currentTime=0:e.mpl.seek(0):e.player.seek(0),!1;if(s>339)return e.playedProcessBar.width(339),o.html(t(".time-counter > .time-total").html()),e.audio?e.hasAudio?e.audio.currentTime=e.audio.duration:e.mpl.setPosition(e.mpl.dom.currentMedia.duration):e.player.seek(e.player.getPosition()),!1;if(e.playedProcessBar.width(s),e.audio)if(e.hasAudio)var d=s/339*e.audio.duration;else d=s/339*e.mpl.dom.currentMedia.duration;else d=s/339*e.player.getDuration;e.showLrc(1e3*d),i=Math.floor(d/60),a=Math.floor(d-60*i),i<10&&(i="0"+i),a<10&&(a="0"+a),o.html(i+":"+a),e.audio?e.hasAudio?e.audio.currentTime=d:e.mpl.setPosition(d):e.player.seek(d)}return!1}))}if(t(".time").on("click",(function(n){if(this.classList.contains("jp-seek-bar"))return!1;if("process-btn"===(n.target||n.srcElement).id)return!1;var r=t(this).offset().left,s=(n.pageX||n.clientX)-r-14.5;if(s<0&&(s=0),s>339&&(s=339),e.playedProcessBar.width(s),e.audio)if(e.hasAudio)var d=s/339*e.audio.duration;else d=s/339*e.mpl.dom.currentMedia.duration;else d=s/339*e.player.getDuration();return e.showLrc(1e3*d),i=Math.floor(d/60),a=Math.floor(d-60*i),i<10&&(i="0"+i),a<10&&(a="0"+a),o.html(i+":"+a),e.audio?e.hasAudio?e.audio.currentTime=d:e.mpl.setPosition(d):e.player.seek(d),!1})),t("#play-btn").on("click",(function(){if(!t(this).hasClass("work-busy-btn")){var o=t(this);o.hasClass("play")?(o.removeClass("play").addClass("pause"),e.hasAudio?audio.play():e.mpl.Play()):(o.removeClass("pause").addClass("play"),e.hasAudio?audio.pause():e.mpl.Pause())}})),e.hasAudio&&this.audio){if(this.audio.duration>0){var i=Math.floor(e.audio.duration/60),a=Math.floor(e.audio.duration-60*i);i<10&&(i="0"+i),a<10&&(a="0"+a),t(".time-counter > .time-total").html(i+":"+a),e.unitWidth=339/e.audio.duration,n(),t("#play-btn").removeClass("work-busy-btn")}else var r=window.setInterval((function(){if(e.audio.duration>0){clearInterval(r);var o=Math.floor(e.audio.duration/60),i=Math.floor(e.audio.duration-60*o);o<10&&(o="0"+o),i<10&&(i="0"+i),t(".time-counter > .time-total").html(o+":"+i),e.unitWidth=339/e.audio.duration,n(),t("#play-btn").removeClass("work-busy-btn"),/safari/i.test(navigator.userAgent)||(e.audio.play(),t("#play-btn").removeClass("play").addClass("pause"))}}),300);e.audio.onplay=function(e){t("#play-btn").removeClass("work-busy-btn"),t("#play-btn").removeClass("play").addClass("pause")},window.setInterval((function(){var t=e.audio.currentTime,n=Math.floor(t/60),i=Math.floor(t-60*n);e.showLrc(1e3*t),n<10&&(n="0"+n),i<10&&(i="0"+i),o.html(n+":"+i);var a=e.unitWidth*t;a<0&&(a=0),a>339&&(a=339),e.playedProcessBar.width(e.unitWidth*t)}),500)}else if(this.audio){var s=e.mpl;s.onPlay=function(){t("#play-btn").removeClass("play").addClass("pause"),d()},s.onStop=function(){t("#play-btn").removeClass("pause").addClass("play"),clearInterval(l),clearInterval(e.LrcTimerId)},s.onPaused=function(){clearInterval(l),clearInterval(e.LrcTimerId)};var d=function(){l=window.setInterval((function(){var t=s.getPosition(),n=Math.floor(t/60),i=Math.floor(t-60*n);e.showLrc(1e3*t),n<10&&(n="0"+n),i<10&&(i="0"+i),o.html(n+":"+i);var a=e.unitWidth*t;a<0&&(a=0),a>339&&(a=339),e.playedProcessBar.width(e.unitWidth*t)}),1e3)};s.onReady=function(o){var i=Math.floor(e.mpl.dom.currentMedia.duration/60),a=Math.floor(e.mpl.dom.currentMedia.duration-60*i);i<10&&(i="0"+i),a<10&&(a="0"+a),t(".time-counter > .time-total").html().html(i+":"+a),e.unitWidth=339/e.mpl.dom.currentMedia.duration,n(),t("#play-btn").removeClass("work-busy-btn")},s.OpenUrl(e.audio.src)}else if(t("#pad_video").length){var c=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);t("#pad_video").attr("src",function(t){var e,o,n,i,a,r,s;for(r=t.length,a=0,s="";a<r;){do{e=c[255&t.charCodeAt(a++)]}while(a<r&&-1==e);if(-1==e)break;do{o=c[255&t.charCodeAt(a++)]}while(a<r&&-1==o);if(-1==o)break;s+=String.fromCharCode(e<<2|(48&o)>>4);do{if(61==(n=255&t.charCodeAt(a++)))return s;n=c[n]}while(a<r&&-1==n);if(-1==n)break;s+=String.fromCharCode((15&o)<<4|(60&n)>>2);do{if(61==(i=255&t.charCodeAt(a++)))return s;i=c[i]}while(a<r&&-1==i);if(-1==i)break;s+=String.fromCharCode((3&n)<<6|i)}return s}(jplayer.video_url))}else if(t("#play-video-btn").length){var l,u=function(t){var e,o,n,i,a,r,s;for(r=t.length,a=0,s="";a<r;){do{e=c[255&t.charCodeAt(a++)]}while(a<r&&-1==e);if(-1==e)break;do{o=c[255&t.charCodeAt(a++)]}while(a<r&&-1==o);if(-1==o)break;s+=String.fromCharCode(e<<2|(48&o)>>4);do{if(61==(n=255&t.charCodeAt(a++)))return s;n=c[n]}while(a<r&&-1==n);if(-1==n)break;s+=String.fromCharCode((15&o)<<4|(60&n)>>2);do{if(61==(i=255&t.charCodeAt(a++)))return s;i=c[i]}while(a<r&&-1==i);if(-1==i)break;s+=String.fromCharCode((3&n)<<6|i)}return s},h=(t("#play-video-btn"),c=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1),{m4v:u(jplayer.video_url),flv:u(jplayer.video_url),poster:jplayer.video_poster}),p=t("#jquery_jplayer_1");p.data("jPlayer"),e.player=p.jPlayer({ready:function(){t(this).jPlayer("setMedia",h)},swfPath:"//cbshowhot.cdn.changbaimg.com/-/5d3a476e21c72b42/jquery.jplayer.swf",solution:"html, flash",supplied:"m4v, flv",size:{width:478,height:478,cssClass:"jp-video-360p"},useStateClassSkin:!0,cssSelector:{play:".jp-play",pause:".jp-pause",seekBar:".jp-seek-bar",seekBarBtn:".jp-seek-bar-btn",playBar:".jp-work-played-bar",currentTime:".jp-current-time",duration:".jp-duration "},play:function(e){if(commonObj.data.newuserRe)return t(this).jPlayer("pause"),void alert("作品正在审核中，暂无法查看");t(this).jPlayer("play"),t(this).jPlayer("pauseOthers"),t("#play-video-btn").addClass("pause")},pause:function(){t("#play-video-btn").addClass("play"),t("#play-video-btn").removeClass("pause")},ended:function(){t(this).jPlayer("setMedia",h)}})}t(".content").each((function(){var e=t.trim(t(this).text());/^\[Жs.*\]$/.test(e)&&t(this).html('<img style="height: 50px;" src="//aliimg.changba.com/cache/photo/s'+e.substring("[Ж/".length,e.indexOf("]"))+'" alt="" />')}))},n.prototype.showLrc=function(t){if(!window.song_lrc)return!1;var e,o=this;o.lrc=song_lrc;for(var n=o.lrc.length,i=0;i<n;i++){var a=o.lrc[i];if(a.start<=t&&a.start+a.duration>=t){e=a;break}}e&&e.text!==o.lrcContainer.text()&&(clearTimeout(o.LrcTimerId),o.lrcContainer.text(e.text),o.LrcTimerId=setTimeout((function(){o.lrcContainer.text("")}),e.start-t+e.duration))},(new n).init()}(jQuery);
//# sourceMappingURL=user_work_jplayer.js.map