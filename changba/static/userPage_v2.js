!function(){var e;(e=function(){this.payTable=$("#pay_table"),this.paySelect=$("#pay_pager_select"),this.rechargeTable=$("#recharge_table"),this.rechargeSelect=$("#rechage_pager_select")}).prototype.init=function(){var e=this._czc=window._czc||[];e&&e.push(["_setAccount","1261879636"]),$('input[type="radio"]').length&&$('input[type="radio"]').radio(),this.bindEvents()},e.prototype.bindEvents=function(){$(document).ready((function(){var e=document.createElement("script");e.src="//s11.cnzz.com/stat.php?id=1254909876&web_id=1254909876",$("head").append(e)}));var e=this,a=$("#userPage-permission-popup"),i=$("#work_list"),s=$("#share_list"),t=1,r=1;$(".userPage-tab-item").on("click",(function(){var e=$(this);if(!e.hasClass("userPage-tab-active-item")){var a=e.parent().children(".userPage-tab-active-item");a.removeClass("userPage-tab-active-item").children(".userPage-icons").attr("class","userPage-icons userPage-"+a.attr("data-name")+"-icon"),e.addClass("userPage-tab-active-item"),e.children(".userPage-icons").attr("class","userPage-icons userPage-"+e.attr("data-name")+"-active-icon"),$(".userPage-tab-content:visible").hide(),$($(".userPage-tab-content")[e.attr("data-index")]).show()}})),$("#commentPermissionBtn").on("click",(function(){a.slideDown()})),$("#cancelPermission").on("click",(function(){a.slideUp()})),$("#savePermission").on("click",(function(){var e=$("input[name='rad_char']:checked").val();e&&$.ajax({type:"POST",url:"/member/personcenter/char_permission.php?status="+e,dataType:"text",success:function(e){a.slideUp(),"error"==e?alert("设置失败，请稍后再试。"):alert("设置成功")},error:function(){a.slideUp(),alert("设置失败，请稍后再试。")}})})),i.delegate(".userPage-work-li","click",(function(){})),s.delegate(".userPage-share-li","click",(function(){})),$("#followBtn").on("click",(function(){var a=$(this).attr("data-status");a&&(2===(a=parseInt(a))||3===a?window.confirm("是否确认取消关注？","取消关注")&&e.relation(a):0!==a&&1!==a||e.relation(a))})),$("#loadWork").on("click",(function(){var e=$(this),a=!1;1===$(".userPage-tab-func").length&&(a=!0),$.ajax({type:"GET",url:"/member/personcenter/loadmore.php?ver=1&pageNum="+t+"&type=0&userid="+userid+"&curuserid="+curuserid,dataType:"json",success:function(s){if(!s)return e.hide(),!1;for(var r="",n=0,o=s.length;n<o;n++){var c,l=s[n],d='style="width:'+(c=(c=(c=l.hotnum)/(allnum/worknum)*2*400)>400?400:c)+'px;"',g='<p data-songname="'+l.songname+'" data-coverpath="'+l.mvCover+'"  data-userid="'+userid+'" data-videoid="'+l.workid+'" class="userPage-edit-icon-wrapper" ><span class="userPage-edit-icon"></span>编辑封面</p>';r+='<li class="userPage-work-li clearfix'+(n%2==0?" userPage-work-even":"")+'"><a href="/s/'+l.enworkid+'" style="color:#999;display:block;" target="_blank">'+l.songname+("style='display:none'"===l.ismv?"":'<img style="vertical-align: top;margin-top: 9px;" src="//cb.cdn.changbaimg.com/images/personcenter/person_mv.png" alt="MV" />')+(0===l.isprivate?"":'<img style="vertical-align: top;" src="//cb.cdn.changbaimg.com/images/personcenter/person_center_min.png" alt="私有" />')+'<div class="userPage-work-detail"><div class="userPage-listen-count" '+d+'></div><div class="userPage-song-detail"><span class="userPage-icons userPage-listen-red-icon"></span>'+l.listennum+'<span class="userPage-icons userPage-gift-red-icon"></span>'+l.flowernum+'<span class="userPage-icons userPage-share-red-icon"></span>'+l.forwardnum+'<span class="userPage-icons userPage-comment-red-icon"></span>'+l.commentnum+(a&&"style='display:inline'"===l.ismv?g:"")+"</div></div></a></li>"}if(i.append(r),s.length<=0)return e.hide(),!1;t++}})})),$("#loadShare").on("click",(function(){var e=$(this);$.ajax({type:"GET",url:"/member/personcenter/loadmore.php?ver=1&pageNum="+r+"&type=1&userid="+userid,dataType:"json",success:function(a){if(!a)return e.hide(),!1;for(var i="",t=0,n=a.length;t<n;t++){var o=a[t];i+='<li class="userPage-share-li"><a href="/s/'+o.enworkid+'" style="color:#999;display:table;width: 100%;" target="_blank"><img src="'+o.headphoto+'" class="userPage-share-img" alt="'+o.nickname+'" /><div class="inline-block userPage-share-song">'+o.songname+'<div class="userPage-share-name">'+o.nickname+'</div></div><div class="inline-block userPage-share-detail">转发：'+o.content+"</div></a></li>"}if(s.append(i),a.length<=0)return e.hide(),!1;r++}})})),$(".userPage-share-icon").on("click",(function(){$(".userPage-tab-item").last().trigger("click")})),$(".userPage-work-icon").on("click",(function(){$(".userPage-tab-item").first().trigger("click")}));var n=!1;$("#giveMember").on("click",(function(){n||($("#giveMemberFrame").dialog({title:"赠送会员"}),n=!0),$("#giveMemberFrame").dialog("show")})),$("#work_list").length<=0&&$(".userPage-work-icon, .userPage-share-icon").on("click",(function(){jAlert("TA还没有开通会员，帮他开通会员即可看到他的全部作品和转发哦~","喜欢TA就帮TA开通会员吧","warnning")}));var o,c,l,d,g=window.URL||window.webkitURL,u='<div class="userPage-dialog userPage-edit-dialog"  style="display: none"><div class="userPage-dialog-editcover"><div><img class="userPage-edit-targetimg" alt="Picture" ></div></div><div class="userPage-dialog-btngroup"><div class="btn btngroup-btn-gray" id="backUpload">返回</div><div class="btn btngroup-btn-red" id="saveEditCover">保存</div></div></div>';$("body").on("click",".userPage-work-li a",(function(a){var i,s=$(this);if(-1!=a.target.className.indexOf("userPage-edit-icon-wrapper")||-1!=a.target.className.indexOf("userPage-edit-icon")){var t=e._czc;t&&t.push(["_trackEvent","会员MV封面修改 编辑封面点击数","click","",0,"body"]),a.preventDefault(),i=s.find(".userPage-edit-icon-wrapper"),c=i.data("songname"),l=i.data("coverpath"),d=i.data("videoid"),userid=i.data("userid"),$("#defaultMvCover").css("background-image","url("+l+")"),$("#selectDialog").dialog({title:"编辑MV封面 -  "+c,onHide:function(){}}).dialog("show")}})).on("click","#backUpload",(function(){var e;confirm("上传的新封面未保存，确定返回重新上传？")&&(e=$(this).closest(".ui-dialog-wrapper"),$(".userPage-edit-dialog").dialog("hide"),e.prev().remove(),e.remove(),$("body").append(u),$("#selectDialog").dialog("show"))})).on("click","#saveEditCover",(function(){var a=$(this),i=$(".userPage-edit-targetimg").cropper("getDataURL",{width:640,height:320},"image/jpeg",1);a.css("pointer-events","none"),$.ajax({type:"POST",url:"/api/web/userInfo/saveImge",data:{userid:userid,workid:d,url:i},dataType:"json",success:function(i){if(a.css("pointer-events","auto"),1==i.code){(t=e._czc)&&t.push(["_trackEvent","会员MV封面修改 上传成功次数","loaded","",0,"body"]);var s=$(this).closest(".ui-dialog-wrapper");$(".userPage-edit-dialog").dialog("hide"),s.prev().remove(),s.remove(),$("body").append(u),$("#mask").show(),$(".update-cover-succ-dialog").show(),setTimeout((function(){$("#mask").hide(),$(".update-cover-succ-dialog").hide(),window.location.reload()}),2e3)}else{var t;(t=e._czc)&&t.push(["_trackEvent","会员MV封面修改 失败次数","loaded","",0,"body"]),alert("更改失败！请重试")}}})})).on("click",".ui-dialog-close",(function(e){var a=$(this).closest(".ui-dialog-wrapper"),i=a.find("#selectDialog"),s=a.find(".userPage-edit-dialog");1==i.length&&(window.confirm("是否确认取消编辑封面？")?$("#selectDialog").dialog("hide"):(e.preventDefault(),$("#selectDialog").dialog("show"))),1==s.length&&(window.confirm("是否确认取消编辑封面？")?($(".userPage-edit-dialog").dialog("hide"),a.prev().remove(),a.remove(),$("body").append(u)):(e.preventDefault(),$(".userPage-edit-dialog").dialog("show")))})),g?$("body #inputImage").on("change",(function(){var e,a=this.files;if(a&&a.length)if(e=a[0],/^image\/(png|jpeg|jpg)$/.test(e.type)){o&&g.revokeObjectURL(o),o=g.createObjectURL(e);var i={aspectRatio:2,autoCropArea:1,multiple:!1,dragCrop:!1,dashed:!1,movable:!0,resizable:!1},s=new Image;s.onload=function(){$(".userPage-edit-targetimg").attr("src",o).cropper(i),$("#selectDialog").dialog("hide"),$(".userPage-edit-dialog").dialog({title:"选择封面图片区域 -  "+c,onHide:function(){}}).dialog("show"),$("#inputImage").val("")},s.src=o}else window.alert("请上传格式为jpg、jpeg、png的图片")})):$("#inputImage").prop("disabled",!0).parent().addClass("disabled")},e.prototype.relation=function(e){userid&&$.ajax({type:"POST",url:"/member/personcenter/oprUserRelation.php?wid="+userid+"&status="+e,dataType:"json",success:function(a){if("no"==a.message){var i=2===e||3===e?"关注":"关注中";$("#followBtn").attr("data-status",2===e||3===e?1:2).html('<span class="userPage-icons userPage-follow-btn-icon"></span>'+i)}else alert(a.message)}})},(new e).init()}();
//# sourceMappingURL=userPage_v2.js.map